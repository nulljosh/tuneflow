#!/bin/bash
# tweet-analyzer: Extract tweet content and generate project implementation plan

URL="$1"
OUTPUT_DIR="$HOME/Documents/Code/tweet-projects"

[ -z "$URL" ] && echo "Usage: tweet-analyzer <tweet-url>" && exit 1

# Extract tweet ID from URL
TWEET_ID=$(echo "$URL" | grep -oE '[0-9]{15,}' | head -1)
[ -z "$TWEET_ID" ] && echo "Error: Invalid tweet URL" && exit 1

SLUG="tweet-${TWEET_ID}"
PROJECT_DIR="$OUTPUT_DIR/$SLUG"

mkdir -p "$PROJECT_DIR"

echo "Analyzing tweet: $URL"
echo "Project dir: $PROJECT_DIR"

# Try bird CLI first
if command -v bird &> /dev/null; then
  echo "Using bird CLI..."
  TWEET_TEXT=$(bird read "$URL" --format json 2>/dev/null | jq -r '.text' 2>/dev/null)
  
  if [ -z "$TWEET_TEXT" ]; then
    echo "Warning: bird failed, falling back to screenshot mode"
    echo "Send screenshot to OpenClaw for analysis"
    exit 1
  fi
else
  echo "bird CLI not installed. Install with: brew install steipete/tap/bird"
  echo "Or send screenshot to OpenClaw for manual analysis"
  exit 1
fi

# Generate implementation plan
cat > "$PROJECT_DIR/IDEA.md" << EOF
# Tweet Implementation Plan

**Source:** $URL
**Extracted:** $(date)

## Original Tweet

$TWEET_TEXT

## Analysis

(Auto-generated by OpenClaw)

### Project Type
- [ ] Web App
- [ ] CLI Tool
- [ ] API Service
- [ ] Desktop App
- [ ] Mobile App
- [ ] Browser Extension

### Tech Stack

**Frontend:**
- 

**Backend:**
- 

**Infrastructure:**
- 

### Core Features

1. 
2. 
3. 

### MVP Scope

**Must Have:**
- 

**Nice to Have:**
- 

### Effort Estimate

- **Time:** 
- **Complexity:** 
- **Dependencies:** 

## Implementation Notes

### Phase 1: Setup


### Phase 2: Core Logic


### Phase 3: UI/UX


### Phase 4: Polish


## Next Steps

- [ ] Create GitHub repo
- [ ] Setup project structure
- [ ] Implement MVP
- [ ] Deploy

---

**Status:** Idea captured
**Priority:** 
**Tags:** 
EOF

echo "âœ“ Idea captured: $PROJECT_DIR/IDEA.md"
echo ""
echo "Next: Ask OpenClaw to analyze and fill in the implementation plan"
